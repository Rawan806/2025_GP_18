plugins {
    id 'com.android.application'
    id 'kotlin-android'
    // Flutter Gradle Plugin لازم يكون بعد Android/Kotlin
    id 'dev.flutter.flutter-gradle-plugin'
    // Firebase (لو عندك google-services.json)
    id 'com.google.gms.google-services'
}

android {
    namespace "com.example.wadiah_app"

    // Flutter variables (يحددها flutter.gradle)
    compileSdk = flutter.compileSdkVersion
    ndkVersion = flutter.ndkVersion

    defaultConfig {
        applicationId "com.example.wadiah_app"

        // خليه يأخذ القيم من Flutter (min/target/versionCode/versionName)
        minSdk     = flutter.minSdkVersion
        targetSdk  = flutter.targetSdkVersion
        versionCode = flutter.versionCode
        versionName = flutter.versionName

        // فعّليه فقط لو تحتاجينه مع minSdk منخفض (إحنا 24 غالبًا ما تحتاجينه)
        // multiDexEnabled true
    }

    // Java/Kotlin 11 متوافق مع Flutter 3.35.x
    compileOptions {
        sourceCompatibility = JavaVersion.VERSION_11
        targetCompatibility = JavaVersion.VERSION_11
    }
    kotlinOptions {
        jvmTarget = JavaVersion.VERSION_11.toString()
    }

    buildTypes {
        release {
            // مؤقتًا نستخدم debug key عشان run/release يشتغل
            signingConfig signingConfigs.debug
            // لو تبين تقليص الحجم لاحقًا:
            // minifyEnabled true
            // shrinkResources true
            // proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }

    // لتفادي تعارض ملفات رخص/تعريفات في بعض المكتبات
    packagingOptions {
        resources {
            excludes += [
                    '/META-INF/{AL2.0,LGPL2.1}',
                    '/META-INF/DEPENDENCIES',
                    '/META-INF/LICENSE',
                    '/META-INF/LICENSE.txt',
                    '/META-INF/LICENSE.md',
                    '/META-INF/NOTICE',
                    '/META-INF/NOTICE.txt',
                    '/META-INF/ASL2.0'
            ]
        }
    }
}

flutter {
    source = "../.."
}

dependencies {
    // Firebase BoM (اختياري لو تستخدمين Firebase – يطابق نسخ المكتبات)
    implementation platform('com.google.firebase:firebase-bom:34.4.0')

    // إذا بتضيفين Firebase libs اكتبي بدون نسخ:
    // implementation 'com.google.firebase:firebase-analytics'
    // implementation 'com.google.firebase:firebase-auth'
    // implementation 'com.google.firebase:firebase-firestore'
    // implementation 'com.google.firebase:firebase-storage'
}
